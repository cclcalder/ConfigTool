using Exceedra.Controls.DynamicGrid.Models;
using Exceedra.SlimGrid;
using Exceedra.TreeGrid.Controls;
using Exceedra.TreeGrid.Models;
using Model.Entity.Listings;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Xml.Linq;
using Telerik.Windows.Controls;

namespace WPF.Pages.Demand
{
    /// <summary>
    /// Interaction logic for DemandControl.xaml
    /// </summary>
    public partial class DemandControl : Page
    {
        public DemandControl()
        {
            InitializeComponent();
            Loaded += DemandControl_Loaded;
        }

        private void DemandControl_Loaded(object sender, RoutedEventArgs e)
        {
            var splitColumnXml = @"<Root><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/></Root>";
            var actualsColumnXml = @"

<Root><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Root>

";

            var forecastColumXml = @"

          <Root><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Root>
";


            var newForecastColumXml = @"

          <Root><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Root>

";

            var xml = XElement.Parse(
@"

<Results><Grid><ParentIdx>15048</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""SPLIT"" Name=""Split"" IsDisplayed=""1"" AggrType=""AVG""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""ACTUALS"" Name=""Actuals"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5456"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""756"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""700"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""NEWFORECAST"" Name=""Modified Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15129</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""SPLIT"" Name=""Split"" IsDisplayed=""1"" AggrType=""AVG""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""ACTUALS"" Name=""Actuals"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5456"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""756"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""700"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""NEWFORECAST"" Name=""Modified Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15171</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""SPLIT"" Name=""Split"" IsDisplayed=""1"" AggrType=""AVG""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""ACTUALS"" Name=""Actuals"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5456"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""756"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""100"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""0"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""700"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""NEWFORECAST"" Name=""Modified Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""700""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""800""  Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Results>

"

);
            var rows = xml.Elements("Grid").SelectMany(g => g.Elements("Rows")).SelectMany(r => r.Elements("Row"));

            for(int i = 4; i<=9; i++)
            {
                rows.Where(r => r.Attribute("Idx").Value == "10").Do(r => r.Element("Columns").Add(XElement.Parse(splitColumnXml.Replace("201602", "20160" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "20").Do(r => r.Element("Columns").Add(XElement.Parse(actualsColumnXml.Replace("201602", "20160" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "30").Do(r => r.Element("Columns").Add(XElement.Parse(forecastColumXml.Replace("201602", "20160" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "40").Do(r => r.Element("Columns").Add(XElement.Parse(newForecastColumXml.Replace("201602", "20160" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
            }

            for (int i = 10; i <= 19; i++)
            {
                rows.Where(r => r.Attribute("Idx").Value == "10").Do(r => r.Element("Columns").Add(XElement.Parse(splitColumnXml.Replace("201602", "2016" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "20").Do(r => r.Element("Columns").Add(XElement.Parse(actualsColumnXml.Replace("201602", "2016" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "30").Do(r => r.Element("Columns").Add(XElement.Parse(forecastColumXml.Replace("201602", "2016" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
                rows.Where(r => r.Attribute("Idx").Value == "40").Do(r => r.Element("Columns").Add(XElement.Parse(newForecastColumXml.Replace("201602", "2016" + i).Replace("WK 3", "WK " + i).Replace("DAY 3", "DAY " + i)).Elements()));
            }


            ThisTreeGrid.DataSource = new Exceedra.TreeGrid.ViewModels.TreeGridViewModel(xml, TreeGridNode.GetProductsAsTreeGridNodes());
            ThisTreeGrid.DataSource.MainColumn = "Products";
            ThisTreeGrid.DataSource.SecondColumn = "Measures";
            ThisTreeGrid.DataSource.Headers.Where(h => h.Visibility == Visibility.Visible).Do(h => h.MouseDown += H_MouseDown);

            WeekSumsColumnCodes = ThisTreeGrid.DataSource.LoadedNodes[0].Data.GetRecordByCode("NEWFORECAST").Properties.Where(p => p.ColumnCode.Length == 6).Select(p => p.ColumnCode).ToList();
            ThisTreeGrid.DataSource.LoadedNodes.SelectMany(n => TreeViewHierarchy.GetFlatTree(n)).Do(n => n.ValueChanged += N_ValueChanged);
        }

        private void N_ValueChanged(Tuple<Tuple<string, string>, TreeGridNode> changedRecord)
        {
            var allNodes = ThisTreeGrid.DataSource.LoadedNodes.SelectMany(n => TreeViewHierarchy.GetFlatTree(n));

            foreach (var node in allNodes)
            {
                var newForecastRowIdx = node.Data.GetRecordByCode("NEWFORECAST").Item_Idx;
                foreach (var weekCode in WeekSumsColumnCodes)
                {
                    UpdateWeekSums(newForecastRowIdx, weekCode, node);
                }
            }
        }

        private static List<string> WeekSumsColumnCodes { get; set; }

        private void N_RecordChanged(Tuple<string, TreeGridNode> changedRecord)
        {
            var record = changedRecord.Item2.Data.GetRecord(changedRecord.Item1);
            record.Properties.Where(p => p.ColumnCode.Length == 6).Do(w => UpdateWeekSums(record.Item_Idx, w.ColumnCode, changedRecord.Item2));
        }

        private void UpdateWeekSums(string recordIdx, string columnCode, TreeGridNode node)
        {
            //var columnCode = changedRecord.Item1.Item2;
            //var recordIdx = changedRecord.Item1.Item1;
            //var node = changedRecord.Item2;

            //This is the week total
            var propertyToChange = node.Data.GetProperty(recordIdx, columnCode.Substring(0, 6));
            propertyToChange.Locked = true;

            var row = node.Data.GetRecord(recordIdx);
            int sum = 0;
            for (int i = 1; i <= 7; i++)
            {
                sum += row.GetProperty(propertyToChange.ColumnCode + "0" + i).Value.AsNumericInt();
            }

            propertyToChange.Value = sum.ToString();

            if (node.Parent != null)
                ThisTreeGrid.DataSource.AggregateUpOneLevel(new List<TreeGridNode> { (TreeGridNode)node.Parent }, recordIdx, propertyToChange.ColumnCode);

        }

        private void H_MouseDown(object sender, MouseButtonEventArgs e)
        {
            var block = (TextBlockWithIcon)sender;
            var weekIdx = (string)block.InnerTextBlock.Tag;
            block.SwitchIcon();

            ThisTreeGrid.DataSource.LoadedNodes.Do(n =>
            {
                TreeViewHierarchy.GetFlatTree(n).Do(t =>
                {
                    for (int i = 1; i <= 7; i++)
                    {
                        t.Data.Records.Select(r => r.Properties.First(p => p.IDX == (weekIdx + "0" + i))).Do(p =>
                        {
                            p.IsDisplayed = !p.IsDisplayed;
                            ThisTreeGrid.DataSource.Headers.First(h => (string)h.Tag == (weekIdx + "0" + i)).Visibility = p.IsDisplayed ? Visibility.Visible : Visibility.Collapsed;
                        });
                    }
                });
            });

            var grids = ThisTreeGrid.ChildrenOfType<SlimGrid>().Where(g => g.Name == "DataDynamicGrid");
            if (!grids.Any())
                throw (new Exception("No Grids Found! Ensure TreeGrid main data grid has the name DataDynamicGrid."));

            //first grid is out root node
            var visibleColumns = grids.First().ReassertVisibleColumns();
            grids.Skip(1).Do(g => g.ReassertVisibleColumns(visibleColumns));

            ThisTreeGrid.DataSource.RefreshSeries();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            var leafs = ThisTreeGrid.DataSource.GetFlatLeafs();

            //Normalise Splits
            var weeks = leafs.First().Data.GetRecordByCode("SPLIT").Properties.Where(p => p.HeaderText.StartsWith("WK")).Select(p => p.IDX);
            foreach (var leaf in leafs)
            {
                var splitRow = leaf.Data.GetRecordByCode("SPLIT");
                var newFcRow = leaf.Data.GetRecordByCode("NEWFORECAST");

                foreach (var week in weeks)
                {
                    var totalFc = newFcRow.GetProperty(week).Value.AsNumeric();
                    var splitProperties = new Property[7];
                    var newFcProperties = new Property[7];
                    for (int i = 1; i <= 7; i++)
                    {
                        splitProperties[i - 1] = splitRow.GetProperty(week + "0" + i);
                        newFcProperties[i - 1] = newFcRow.GetProperty(week + "0" + i);
                    }
                    var splitSum = splitProperties.Sum(p => p.Value.AsNumeric());

                    if (splitSum == 0.0) //Special case if user enters all 0's
                        splitProperties.Do(p => p.Value = "0.1429");
                    else
                        splitProperties.Where(p => p.Value.IsNumeric()).Do(p => p.Value = (p.Value.AsNumeric() / splitSum).ToString());

                    for (int i = 1; i <= 7; i++)
                    {
                        newFcProperties[i - 1].Value = (splitProperties[i - 1].Value.AsNumeric() * totalFc).ToString();
                    }
                }
            }

            ThisTreeGrid.DataSource.RefreshSeries();
        }
    }
}
