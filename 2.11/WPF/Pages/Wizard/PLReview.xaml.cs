using System.Net;
using System.Timers;
using System.Windows.Threading;

namespace WPF.Wizard
{
    using Exceedra.TreeGrid.Models;
    using Model.DataAccess.Listings;
    using System;
    using System.Linq;
    using System.Reflection;
    using System.Windows;
    using System.Windows.Controls;
    using System.Xml.Linq;
    using ViewModels;

    /// <summary>
    /// Interaction logic for PLReview.xaml
    /// </summary>
    public partial class PLReview : Page
    {
        public PLReview()
            : this(null)
        {
        }
        private PromotionWizardViewModelBase _viewModel;
        public PLReview(PromotionWizardViewModelBase viewModel)
        {
            if (viewModel == null) throw new ArgumentNullException("viewModel");
            InitializeComponent();
            DataContext = viewModel;
            Loaded += Page_Loaded;
            _viewModel = viewModel;
            _viewModel.PropertyChanged += ViewModelPropertyChanged;

            BottomRowResizeTimer.Tick += ResizeBottomRow;
        }

        private void Page_Loaded(object sender, System.Windows.RoutedEventArgs e)
        {
            App.LogError("PromoDashboard loaded @" + DateTime.Now);
            UploadFile.Load("PROMOTION$PROMO", _viewModel.CurrentPromotion.Id, App.Configuration.StorageDetails);

            //DashboardData.Header = App.CurrentLang.GetValue("Label_Dashboard_Grid1", "Grid 1");
            //DashboardData2.Header = App.CurrentLang.GetValue("Label_Dashboard_Grid2", "Grid 2");
            //DashboardData3.Header = App.CurrentLang.GetValue("Label_Dashboard_Grid3", "Grid 3");
            //DashboardData4.Header = App.CurrentLang.GetValue("Label_Dashboard_Grid4", "Grid 4");

            var xml = XElement.Parse(
@"<Results><Root>  <NameOverride>Total Promotion</NameOverride><Grid><ParentIdx>15048</ParentIdx><Seasonal_Idx>1</Seasonal_Idx>
<Rows>
<Row Idx=""10"" Code=""EPOS"" Name=""Actual (EPOS)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row>
<Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row>
<Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row>
<Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns>
<Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row>
<Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row>
</Rows></Grid><Grid><ParentIdx>15129</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""EPOS"" Name=""Actual (EPOS)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15171</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""EPOS"" Name=""Actual (EPOS)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root><Root><NameOverride>Cannibalised</NameOverride><Grid><ParentIdx>15006</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""EPOS"" Name=""Actual (EPOS)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15272</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""EPOS"" Name=""Actual (EPOS)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root></Results>"

//@"<Results><Root><NameOverride>Total Promotion</NameOverride><Grid><ParentIdx>15048</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15129</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15171</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root><Root><NameOverride>Cannibalised</NameOverride><Grid><ParentIdx>15006</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15272</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""20"" Code=""SHIPMENTS"" Name=""Actual (Shipments)"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Current Forecast Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" BackgroundColour=""#BAFF97"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" BackgroundColour=""#BAFF97"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" BackgroundColour=""#BAFF97"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" BackgroundColour=""#BAFF97"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""BASEINCREMENTAL"" Name=""Base + Incremental"" IsDisplayed=""0""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""2400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""3400"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""1600"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""720"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""50"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK -1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" BackgroundColour=""#B3FFF2"" Name=""WK 0"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201603"" Name=""WK 2"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201604"" Name=""WK 3"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201605"" Name=""WK PP1"" IsEditable=""1"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201606"" Name=""WK PP2"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root></Results>"

);
            var mylab = new Label();
            mylab.HorizontalContentAlignment = HorizontalAlignment.Left;

            DemoTree.DataSource = new Exceedra.TreeGrid.ViewModels.TreeGridViewModel(xml, TreeGridNode.GetProductsAsTreeGridNodes());
            DemoTree.DataSource.MainColumn = "Products";
            DemoTree.DataSource.SecondColumn = "Measures";


            //DemoTree 2 - Product History

            var coreXml = XElement.Parse(@"<Results><MetaData><ChartLine>WK 37</ChartLine><MarkedArea HorizontalTo=""WK 37"" HorizontalFrom=""WK 1"" Fill=""#43262626""></MarkedArea></MetaData><Root><NameOverride>Total Promotion</NameOverride><Grid><ParentIdx>15048</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""PROMOVOL"" Name=""Base + Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15129</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""PROMOVOL"" Name=""Base + Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15171</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""PROMOVOL"" Name=""Base + Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root><Root><NameOverride>Cannibalised</NameOverride><Grid><ParentIdx>15006</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""PROMOVOL"" Name=""Base + Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid><Grid><ParentIdx>15272</ParentIdx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""PROMOVOL"" Name=""Base + Promo Vol"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""BASE"" Name=""Base"" IsDisplayed=""1""><Columns><Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows></Grid></Root></Results>");

            var promoVolWeekXml = @"<Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/>";
            var baseVolWeekXml = @"<Column Idx=""201501"" Name=""WK 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""800"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/>";

            var rows = coreXml.Elements("Root").SelectMany(r => r.Elements("Grid")).SelectMany(g => g.Elements("Rows")).SelectMany(r => r.Elements("Row")).ToList();

            for (int i = 2; i <= 52; i++)
            {
                var baseVol = GenerateBaseVol();
                rows.Where(r => r.Attribute("Idx").Value == "10").Do(r => r.Element("Columns").Add(XElement.Parse(promoVolWeekXml.Replace("201501", "2015" + (i > 9 ? i.ToString() : ("0" + i))).Replace("WK 1", "WK " + i).Replace("-", GenerateVol(i) == "-" ? baseVol : (baseVol.AsNumeric() + GenerateVol(i).AsNumeric()).ToString()).Insert(7, baseVol.AsNumeric() + GenerateVol(i).AsNumeric() > 850 ? @" BackgroundColour=""#B3FFF2""" : ""))));
                rows.Where(r => r.Attribute("Idx").Value == "20").Do(r => r.Element("Columns").Add(XElement.Parse(baseVolWeekXml.Replace("201501", "2015" + (i > 9 ? i.ToString() : ("0" + i))).Replace("WK 1", "WK " + i).Replace("800", baseVol))));
            }

            DemoTree2.DataSource = new Exceedra.TreeGrid.ViewModels.TreeGridViewModel(coreXml, TreeGridNode.GetProductsAsTreeGridNodes());
            DemoTree2.DataSource.MainColumn = "Products";
            DemoTree2.DataSource.SecondColumn = "Volumes";
        }

        private string GenerateVol(int i)
        {
            switch (i)
            {
                case 7: return "500";
                case 8: return "1200";
                case 9: return "800";
                case 10: return "-80";

                case 27: return "500";
                case 28: return "1200";
                case 29: return "800";
                case 30: return "-80";

                case 40: return "1600";
                case 41: return "2600";
                case 42: return "800";
                case 43: return "-80";
            }

            //if (i >= 7 && i <= 10)
            //    return (i * ((100 - i) + (5 * i))).ToString();

            //if (i >= 27 && i <= 30)
            //    return ((i - 20) * ((100 - i) + (5 * (i - 20)))).ToString();


            return "-";
        }

        Random r = new Random();

        private string GenerateBaseVol()
        {
            var i = r.Next(40);
            var j = r.Next(2) == 1;

            var k = 800 + (j ? i : -i);

            return k.ToString();
            
        }

        private void btnBack_Click(object sender, RoutedEventArgs e)
        {
        }


        private void ViewModelPropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
        {
            //if (e.PropertyName == "DashboardRVM")
            //{
            //    DashboardData.IsReadOnlyMode = _viewModel.IsReadOnlyPromo;
            //    DashboardData.Visibility = (_viewModel.DashboardRVM != null && _viewModel.DashboardRVM.Records.Any()
            //        ? Visibility.Visible
            //        : Visibility.Hidden);
            //}

        }

        private void Frame_NavigationFailed(object sender, System.Windows.Navigation.NavigationFailedEventArgs e)
        {
            string temp = e.Exception.Message;
        }

        private void Frame_Navigating(object sender, System.Windows.Navigation.NavigatingCancelEventArgs e)
        {
            var request = e.WebRequest as HttpWebRequest;

            if (request != null)
            {
                request.CookieContainer = new CookieContainer();
                request.AllowAutoRedirect = false;
            }
        }

        public Visibility IsPromotionScenarioVisible
        {
            get { return App.Configuration.IsPromotionScenarioActive ? Visibility.Visible : Visibility.Collapsed; }
        }

        public Visibility IsPromoReviewDetailTabVisible
        {
            get { return App.Configuration.IsPromoReviewDetailTabEnabled ? Visibility.Visible : Visibility.Collapsed; }
        }

        public Visibility IsPromoDocumentTabVisible
        {
            get { return App.Configuration.IsPromoReviewDetailTabEnabled ? Visibility.Visible : Visibility.Collapsed; }
        }


        public Visibility IsPromoReportTabVisible
        {
            get { return App.Configuration.IsPromoReportTabVisible ? Visibility.Visible : Visibility.Collapsed; }
        }

        private static readonly DispatcherTimer BottomRowResizeTimer = new DispatcherTimer { Interval = new TimeSpan(0, 0, 0, 0, 250), IsEnabled = false };

        private void PlReviewPage_SizeChanged(object sender, System.Windows.SizeChangedEventArgs e)
        {
            BottomRowResizeTimer.IsEnabled = true;
            BottomRowResizeTimer.Stop();
            BottomRowResizeTimer.Start();
        }

        private void ResizeBottomRow(object sender, EventArgs e)
        {
            BottomRowResizeTimer.IsEnabled = false;

            if (bottomSettings.ActualWidth + bottomButtons.ActualWidth + Scenarios.ActualWidth + 16 > BottomGrid.ActualWidth)
            {
                if (bottomSettings.ActualWidth + Scenarios.ActualWidth + 20 > BottomGrid.ActualWidth)
                {
                    BottomRow.Height = new GridLength(120);
                    Scenarios.SetValue(Grid.RowProperty, 1);
                    Scenarios.SetValue(Grid.ColumnProperty, 0);
                    bottomButtons.SetValue(Grid.RowProperty, 2);
                }
                else
                {
                    BottomRow.Height = new GridLength(80);
                    Scenarios.SetValue(Grid.RowProperty, 0);
                    Scenarios.SetValue(Grid.ColumnProperty, 1);
                    bottomButtons.SetValue(Grid.RowProperty, 1);
                }
            }
            else
            {
                Scenarios.SetValue(Grid.RowProperty, 0);
                Scenarios.SetValue(Grid.ColumnProperty, 1);
                BottomRow.Height = new GridLength(40);
                bottomButtons.SetValue(Grid.RowProperty, 0);
            }
        }


    }
    public static class WebBrowserUtility
    {
        public static readonly DependencyProperty BindableSourceProperty =
            DependencyProperty.RegisterAttached("BindableSource", typeof(string), typeof(WebBrowserUtility), new UIPropertyMetadata(null, BindableSourcePropertyChanged));

        public static string GetBindableSource(DependencyObject obj)
        {
            return (string)obj.GetValue(BindableSourceProperty);
        }

        public static void SetBindableSource(DependencyObject obj, string value)
        {
            obj.SetValue(BindableSourceProperty, value);
        }

        public static void BindableSourcePropertyChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)
        {
            WebBrowser browser = o as WebBrowser;
            if (browser != null)
            {
                string uri = e.NewValue as string;
                browser.Source = !String.IsNullOrEmpty(uri) ? new Uri(uri) : null;
            }
        }

    }
}