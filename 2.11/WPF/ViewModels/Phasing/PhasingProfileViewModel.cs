using Exceedra.Controls.DynamicGrid.Models;
using Exceedra.Controls.DynamicGrid.ViewModels;
using Exceedra.SingleSelectCombo.ViewModel;
using Exceedra.TreeGrid.Models;
using Exceedra.TreeGrid.ViewModels;
using Model.Entity;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Input;
using System.Xml.Linq;
using ViewHelper;
using ViewModels;
using WPF.UserControls.Filters.ViewModels;

namespace WPF.ViewModels.Phasing
{
    public class PhasingProfilesViewModel : ViewModelBase
    {
        public PhasingProfilesViewModel()
        {
            LoadFilters();
        }

        private void LoadFilters()
        {
            Filters = new FilterViewModel
            {
                UseListingsGroups = true,
                ApplyFilter = ApplyFilter,
                NoSingleTree = true,
                CurrentScreenKey = ScreenKeys.PHASINGPROFILES,
                IsUsingOtherFilters = true,
                IsCustomDropdownForDemo = true
            };

            Filters.Load();
        }

        private void ApplyFilter()
        {
            var xml = new XElement("Rows");
            var rowString = @"<Row Idx=""10"" Code=""201601"" Name=""201601"" IsDisplayed=""1""><Columns>
<Column Idx=""01"" Width=""60"" Name=""DAY 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.07"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""02"" Width=""60"" Name=""DAY 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.08"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""03"" Width=""60"" Name=""DAY 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""04"" Width=""60"" Name=""DAY 4"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.25"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""05"" Width=""60"" Name=""DAY 5"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""06"" Width=""60"" Name=""DAY 6"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""07"" Width=""60"" Name=""DAY 7"" IsEditable=""0"" IsDisplayed=""1"" Value=""0.1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
</Columns></Row>";
            for (int i = 1; i < 53; i++)
            {
                xml.Add(XElement.Parse(rowString.Replace("201601", "20160" + i).Replace("2016/01", "2016/0" + i)));
            }

            //var xml = XElement.Parse(@"<Rows><Row Idx=""10"" Code=""SPLIT"" Name=""Split"" IsDisplayed=""1"" AggrType=""AVG""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.5"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.3"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.5"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.3"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""1"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.2"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.5"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""0.3"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""20"" Code=""ACTUALS"" Name=""Actuals"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""1000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""2500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""1500"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""30"" Code=""FORECAST"" Name=""Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1"" IsEditable=""0"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" IsEditable=""0"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" IsEditable=""0"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" IsEditable=""0"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row><Row Idx=""40"" Code=""NEWFORECAST"" Name=""Modified Forecast"" IsDisplayed=""1""><Columns><Column Idx=""201552"" Name=""WK 1"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155201"" Name=""DAY 1.1"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155202"" Name=""DAY 1.2"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155203"" Name=""DAY 1.3"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155204"" Name=""DAY 1.4"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155205"" Name=""DAY 1.5"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155206"" Name=""DAY 1.6"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20155207"" Name=""DAY 1.7"" BackgroundColour=""#CFCDCD"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201601"" Name=""WK 2"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160101"" Name=""DAY 2.1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160102"" Name=""DAY 2.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160103"" Name=""DAY 2.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160104"" Name=""DAY 2.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160105"" Name=""DAY 2.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160106"" Name=""DAY 2.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160107"" Name=""DAY 2.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""201602"" Name=""WK 3"" BackgroundColour=""#B3FFF2"" IsEditable=""0"" IsDisplayed=""1"" IsExpandable=""1"" Value=""10000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160201"" Name=""DAY 3.1""  BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""2000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160202"" Name=""DAY 3.2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160203"" Name=""DAY 3.3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160204"" Name=""DAY 3.4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""5000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160205"" Name=""DAY 3.5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160206"" Name=""DAY 3.6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""3000"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/><Column Idx=""20160207"" Name=""DAY 3.7"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""0"" Value=""-"" Format=""N0"" ControlType=""TreeGridCell"" Alignment=""Right""/></Columns></Row></Rows>");
            PhasingHistoryGrid = RecordViewModel.LoadWithNewXml(xml);


            ConfigureProfilesTreeGrid.GetFlatDataGrids().SelectMany(g => g.Records).SelectMany(r => r.Properties.Where(p => p.ControlType.ToLower() == "dropdown")).Do(p =>
            {
                p.Locked = true;
                p.Values = new System.Collections.ObjectModel.ObservableCollection<Exceedra.DynamicGrid.Models.Option>
                {
                    new Exceedra.DynamicGrid.Models.Option { IsSelected = true, Item_Idx = "1", Item_Name = "Common Profile", Background = "#33FF1111" },
                    new Exceedra.DynamicGrid.Models.Option { IsSelected = false, Item_Idx = "2", Item_Name = "Easter Profile", Background = "#3311FF11" },
                    new Exceedra.DynamicGrid.Models.Option { IsSelected = false, Item_Idx = "3", Item_Name = "Xmas Profile", Background = "#331111FF" }
                };
                p.Locked = false;
            });
        }

        private void P_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
        {
        }

        private RecordViewModel _phasingCalculationGrid = RecordViewModel.LoadWithNewXml(XElement.Parse(@"<Rows><Row Idx=""10"" Code=""Mode"" Name=""Mode"" IsDisplayed=""1"">
<Columns>
<Column Idx=""01"" Width=""60"" Name=""DAY 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""02"" Width=""60"" Name=""DAY 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""03"" Width=""60"" Name=""DAY 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""04"" Width=""60"" Name=""DAY 4"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""05"" Width=""60"" Name=""DAY 5"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""06"" Width=""60"" Name=""DAY 6"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""07"" Width=""60"" Name=""DAY 7"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
</Columns></Row>

<Row Idx=""20"" Code=""Mean"" Name=""Mean"" IsDisplayed=""1"">
<Columns>
<Column Idx=""01"" Width=""60"" Name=""DAY 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""02"" Width=""60"" Name=""DAY 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""03"" Width=""60"" Name=""DAY 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""04"" Width=""60"" Name=""DAY 4"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""05"" Width=""60"" Name=""DAY 5"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""06"" Width=""60"" Name=""DAY 6"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""07"" Width=""60"" Name=""DAY 7"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
</Columns></Row>

<Row Idx=""30"" Code=""Custom"" Name=""Custom"" IsDisplayed=""1"">
<Columns>
<Column Idx=""01"" Width=""60"" Name=""DAY 1"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""02"" Width=""60"" Name=""DAY 2"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""03"" Width=""60"" Name=""DAY 3"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""04"" Width=""60"" Name=""DAY 4"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""05"" Width=""60"" Name=""DAY 5"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""06"" Width=""60"" Name=""DAY 6"" BackgroundColour=""#BAFF97"" IsEditable=""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""07"" Width=""60"" Name=""DAY 7"" BackgroundColour=""#BAFF97"" IsEditable =""1"" IsDisplayed=""1"" Value=""0"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
</Columns></Row>
</Rows>"));
        public RecordViewModel PhasingCalculationGrid
        {
            get { return _phasingCalculationGrid; }
            set
            {
                _phasingCalculationGrid = value;
                NotifyPropertyChanged(this, vm => vm.PhasingCalculationGrid);
            }
        }

        private RecordViewModel _phasingHistoryGrid = RecordViewModel.LoadWithNewXml(XElement.Parse(@"<Rows><Row Idx=""10"" Code=""201601"" Name=""No Data"" IsDisplayed=""1"">
<Columns>
<Column Idx=""01"" Width=""60"" Name=""DAY 1"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""02"" Width=""60"" Name=""DAY 2"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""03"" Width=""60"" Name=""DAY 3"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""04"" Width=""60"" Name=""DAY 4"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""05"" Width=""60"" Name=""DAY 5"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""06"" Width=""60"" Name=""DAY 6"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
<Column Idx=""07"" Width=""60"" Name=""DAY 7"" IsEditable=""0"" IsDisplayed=""1"" Value=""-"" Format=""N2"" ControlType=""TreeGridCell"" Alignment=""Right""/>
</Columns></Row></Rows>"));

        public RecordViewModel PhasingHistoryGrid
        {
            get { return _phasingHistoryGrid; }
            set
            {
                _phasingHistoryGrid = value;
                NotifyPropertyChanged(this, vm => vm.PhasingHistoryGrid);
            }
        }

        private TreeGridViewModel _configureProfilesTreeGrid = new TreeGridViewModel(XElement.Parse(
            @"

<Results><Grid>
<Parent_Idx>15134</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid><Grid>
<Parent_Idx>15318</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid><Grid>
<Parent_Idx>15088</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid><Grid>
<Parent_Idx>15397</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid><Grid>
<Parent_Idx>50001</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid><Grid>
<Parent_Idx>60001</Parent_Idx><Seasonal_Idx>1</Seasonal_Idx><Rows><Row Idx=""10"" Code=""Phases"" Name=""Phases"" IsDisplayed=""1""><Columns><Column Idx=""201601"" Name=""201601"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201602"" Name=""201602"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201603"" Name=""201603"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201604"" Name=""201604"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201605"" Name=""201605"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201606"" Name=""201606"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201607"" Name=""201607"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201608"" Name=""201608"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201609"" Name=""201609"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201610"" Name=""201610"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201611"" Name=""201611"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201612"" Name=""201612"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201613"" Name=""201613"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201614"" Name=""201614"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201615"" Name=""201615"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201616"" Name=""201616"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201617"" Name=""201617"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201618"" Name=""201618"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201619"" Name=""201619"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201620"" Name=""201620"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201621"" Name=""201621"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201622"" Name=""201622"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201623"" Name=""201623"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201624"" Name=""201624"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201625"" Name=""201625"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201626"" Name=""201626"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201627"" Name=""201627"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201628"" Name=""201628"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201629"" Name=""201629"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201630"" Name=""201630"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201631"" Name=""201631"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201632"" Name=""201632"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201633"" Name=""201633"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201634"" Name=""201634"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201635"" Name=""201635"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201636"" Name=""201636"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201637"" Name=""201637"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201638"" Name=""201638"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201639"" Name=""201639"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201640"" Name=""201640"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201641"" Name=""201641"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201642"" Name=""201642"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201643"" Name=""201643"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201644"" Name=""201644"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201645"" Name=""201645"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201646"" Name=""201646"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201647"" Name=""201647"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201648"" Name=""201648"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201649"" Name=""201649"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201650"" Name=""201650"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201651"" Name=""201651"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/><Column Idx=""201652"" Name=""201652"" Width=""120"" IsEditable=""1"" IsDisplayed=""1"" Value=""-"" ControlType=""Dropdown""/></Columns></Row></Rows></Grid></Results>

"), TreeGridNode.GetProductsAsTreeGridNodes());
        public TreeGridViewModel ConfigureProfilesTreeGrid
        {
            get { return _configureProfilesTreeGrid; }
            set
            {
                _configureProfilesTreeGrid = value;
                NotifyPropertyChanged(this, vm => vm.ConfigureProfilesTreeGrid);
            }
        }

        private FilterViewModel _filters;
        public FilterViewModel Filters
        {
            get { return _filters; }
            set
            {
                _filters = value;
                NotifyPropertyChanged(this, vm => vm.Filters);
            }
        }

        private string _seasonalProfileName = "";
        public string SeasonalProfileName
        {
            get { return _seasonalProfileName; }
            set
            {
                _seasonalProfileName = value;
                NotifyPropertyChanged(this, vm => vm.SeasonalProfileName);
            }
        }

        private SingleSelectViewModel _phasingProfiles = new SingleSelectViewModel { Items = new List<Model.Entity.Generic.ComboboxItem>() };
        public SingleSelectViewModel PhasingProfiles
        {
            get { return _phasingProfiles; }
            set
            {
                _phasingProfiles = value;
                NotifyPropertyChanged(this, vm => vm.PhasingProfiles);
            }
        }

        public ICommand CalculatePhasingCommand
        {
            get { return new ViewCommand(CalculatePhasing); }
        }

        public ICommand NormalisePhasingCommand
        {
            get { return new ViewCommand(NormaliseCustomerPhase); }
        }

        public ICommand SaveModeProfileCommand
        {
            get { return new ViewCommand(SaveModeProfile); }
        }

        public ICommand SaveMeanProfileCommand
        {
            get { return new ViewCommand(SaveMeanProfile); }
        }

        public ICommand SaveCustomProfileCommand
        {
            get { return new ViewCommand(SaveCustomProfile); }
        }

        private void SaveModeProfile(object o)
        {
            PhasingProfiles.Items.Add(new Model.Entity.Generic.ComboboxItem { Idx = "1", IsEnabled = true, Name = SeasonalProfileName + "Mode" });
            SeasonalProfileName = "";
        }

        private void SaveMeanProfile(object o)
        {
            PhasingProfiles.Items.Add(new Model.Entity.Generic.ComboboxItem { Idx = "1", IsEnabled = true, Name = SeasonalProfileName + "Mean" });
            SeasonalProfileName = "";
        }

        private void SaveCustomProfile(object o)
        {
            PhasingProfiles.Items.Add(new Model.Entity.Generic.ComboboxItem { Idx = "1", IsEnabled = true, Name = SeasonalProfileName + "Custom" });
            SeasonalProfileName = "";
        }

        private IEnumerable<float[]> GetWeeklyPhases()
        {
            return PhasingHistoryGrid.Records.Select(r => r.Properties.Where(p => p.IsDisplayed).Take(7).Select(p => p.Value.AsNumeric()).ToArray());
        }

        private void CalculatePhasing(object obj)
        {
            var weeklyPhases = GetWeeklyPhases();

            var meanPhase = GetMeanPhase();
            var modePhase = GetModePhase();

            var mode = CalculateMode(weeklyPhases);
            var mean = CalculateMean(weeklyPhases);

            for (int i = 0; i < 7; i++)
            {
                modePhase.ElementAt(i).Value = mode[i].ToString();
                meanPhase.ElementAt(i).Value = mean[i].ToString();
            }
        }

        private float[] CalculateMode(IEnumerable<float[]> weeklyPhases)
        {
            var phases = new List<WeekPhase>();

            foreach (var phase in weeklyPhases)
            {
                var matchingPhase = phases.SingleOrDefault(p => Enumerable.SequenceEqual(p.Phase, phase));

                if (matchingPhase != null)
                    matchingPhase.Occurences++;
                else
                    phases.Add(new WeekPhase(phase));
            }

            var mostOccurences = phases.Max(p => p.Occurences);
            return phases.First(p => p.Occurences == mostOccurences).Phase;
        }

        private float[] CalculateMean(IEnumerable<float[]> weeklyPhases)
        {
            var numWeeks = weeklyPhases.Count();
            var totalPhase = new float[7];

            foreach (var phase in weeklyPhases)
            {
                for (int i = 0; i < 7; i++)
                    totalPhase[i] += phase[i];
            }

            for (int i = 0; i < 7; i++)
                totalPhase[i] = totalPhase[i] / numWeeks;

            return NormalisePhase(totalPhase);
        }

        private float[] NormalisePhase(float[] phase)
        {
            var sum = phase.Sum();

            for (int i = 0; i < 7; i++)
            {
                phase[i] = (sum == 0.00) ? (float)0.14286 : (phase[i] / sum);
            }

            return phase;
        }

        private void NormaliseCustomerPhase(object obj)
        {
            var customPhase = GetCustomPhase();

            var normalised = NormalisePhase(customPhase.Select(w => w.Value.AsNumeric()).ToArray());

            for (int i = 0; i < 7; i++)
            {
                customPhase.ElementAt(i).Value = normalised[i].ToString();
            }
        }

        private IEnumerable<Property> GetMeanPhase() { return PhasingCalculationGrid.GetRecordByName("Mean").Properties.Where(p => p.IsDisplayed).Take(7); }
        private IEnumerable<Property> GetModePhase() { return PhasingCalculationGrid.GetRecordByName("Mode").Properties.Where(p => p.IsDisplayed).Take(7); }
        private IEnumerable<Property> GetCustomPhase() { return PhasingCalculationGrid.GetRecordByName("Custom").Properties.Where(p => p.IsDisplayed).Take(7); }
    }

    public class WeekPhase
    {
        public WeekPhase(float[] p)
        {
            Phase = p;
            Occurences = 1;
        }

        public int Occurences { get; set; }
        public float[] Phase { get; set; }
    }
}
